asyncapi: 2.4.0
info:
  title: Distance Data
  version: 0.0.1.1000A
  description: Distance data profile
servers:
  default:
    url: '{device}:{port}'
    description: Allows you to connect using the MQTT protocol.
    variables:
      device:
        default: 192.168.0.1
      port:
        enum:
          - '5676'
          - '5677'
        default: '5676'
    protocol: mqtt
channels:
  'sick/device/distance-data/{deviceId}':
    publish:
      message:
        $ref: '#/components/messages/distanceData'
    parameters:
      deviceId:
        schema:
          type: string
        description: >-
          A unique identifier for the device, e.g. a combination of device name,
          version and serial number or a generated UUID
components:
  messages:
    distanceData:
      headers:
        type: object
        properties:
          qos:
            $ref: '#/components/schemas/MQTTQoSHeader'
          retainFlag:
            $ref: '#/components/schemas/MQTTRetainHeader'
      payload:
        $ref: '#/components/schemas/DistanceDataPayload'
  schemas:
    MQTTQoSHeader:
      title: qos
      description: Quality of Service
      type: integer
      format: int32
      default: 1
      enum:
        - 0
        - 1
        - 2
    MQTTRetainHeader:
      title: retainFlag
      description: >
        This flag determines if the message will be saved by the broker for the
        specified topic as last known good value. New clients that subscribe to
        that topic will receive the last retained message on that topic
        instantly after subscribing.
      type: boolean
      default: false
    DistanceDataPayload:
      type: object
      required:
        - distance
        - unit
      properties:
        timestamp:
          description: UTC timestamp according to RFC 3339
          type: string
          example: '2022-05-23T06:34:42.694Z'
        distance:
          description: Distance value in relation to the specified unit
          type: number
          format: float
          example: 12.45
        unit:
          description: Unit of distance value
          type: string
          example: mm